{"version":3,"sources":["blag-app.js"],"names":["html","GluonElement","onRouteChange","currentPath","currentQuery","currentHash","fontStyle","document","createTextNode","styleNode","createElement","appendChild","head","BlagApp","template","[object Object]","super","this","_routes","connectedCallback","path","query","hash","Object","keys","length","setTimeout","_routeChanged","newRoute","oldRoute","oldPath","_oldPath","article","newPath","match","$","articlePage","classList","remove","add","console","warn","window","history","back","Array","prototype","map","call","pages","children","page","getAttribute","dispatchEvent","Event","customElements","define","is"],"mappings":"eAASA,kBAAMC,MAAoB,8CAC1BC,iBAAeC,kBAAaC,iBAAcC,MAAmB,wCAC/D,4BACA,yBAEP,MAAMC,EAAYC,SAASC,eAAe,6ZAUpCC,EAAYF,SAASG,cAAc,SACzCD,EAAUE,YAAYL,GACtBC,SAASK,KAAKD,YAAYF,SAEpBI,UAAgBZ,EACpBa,eACE,OAAOd;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAgDTe,cACEC,QACAC,KAAKC,WAGPH,oBACEC,MAAMG,oBACNjB,EAAc,CAACkB,EAAMC,EAAOC,KAI1B,GAAyC,IAArCC,OAAOC,KAAKP,KAAKC,SAASO,OAI5B,YAHAC,WAAW,KACTT,KAAKU,cAAcC,SAAUC,WAC5B,GAIL,MAAMC,EAAUb,KAAKc,SACrB,IAEIC,EAFAC,EAAUb,GAGTY,EAAUC,EAAQC,MAAM,2BAC3BD,EAAU,WACVhB,KAAKkB,EAAEC,YAAYJ,QAAUA,EAAQ,IAGvCf,KAAKc,SAAWE,EAGZhB,KAAKC,QAAQY,IACfb,KAAKC,QAAQY,GAASO,UAAUC,OAAO,WAIrCrB,KAAKC,QAAQe,GACfhB,KAAKC,QAAQe,GAASI,UAAUE,IAAI,WAGhCtB,KAAKC,QAAQY,KACfU,QAAQC,KAAK,iCACbC,OAAOC,QAAQC,UAMrBC,MAAMC,UAAUC,IAAIC,KAAK/B,KAAKkB,EAAEc,MAAMC,SAAUC,IAC9ClC,KAAKC,QAAQiC,EAAKC,aAAa,UAAYD,IAI7ClC,KAAKc,SAAW,IAGhBW,OAAOW,cAAc,IAAIC,MAAM,sBAInCC,eAAeC,OAAO3C,EAAQ4C,GAAI5C","file":"blag-app.js","sourcesContent":["import { html, GluonElement } from '../gluonjs/gluon.js';\nimport { onRouteChange, currentPath, currentQuery, currentHash } from '../gluon-router/gluon-router.js';\nimport './blag-page-main.js';\nimport './blag-page-article.js';\n\nconst fontStyle = document.createTextNode(`\n  @font-face {\n    font-family: 'Cinzel';\n    font-style: normal;\n    font-weight: 900;\n    src: local('Cinzel Black'), local('Cinzel-Black'), url(https://fonts.gstatic.com/s/cinzel/v7/u8CPqNcpTcF_eDy_SWp9tVtXRa8TVwTICgirnJhmVJw.woff2) format('woff2');\n    unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2212, U+2215;\n  }\n`);\n\nconst styleNode = document.createElement('style');\nstyleNode.appendChild(fontStyle);\ndocument.head.appendChild(styleNode);\n\nclass BlagApp extends GluonElement {\n  get template() {\n    return html`\n    <style>\n      :host {\n        display: block;\n      }\n      .header {\n        position: fixed;\n        top: 0;\n        width: 100%;\n        padding: 0 20px;\n        background: rgba(255,255,255,0.97);\n        height: 65px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n      }\n      .header-title {\n        font-family: 'Cinzel', sans-serif;\n        text-decoration: none;\n        color: black;\n        font-size: 36px;\n      }\n      @media (max-width: 767px) {\n        .header {\n          height: 56px;\n          justify-content: space-between;\n        }\n\n        .header-title {\n          font-size: 30px;\n        }\n      }\n      #pages {\n        padding-top: 65px;\n      }\n      #pages > *:not(.visible) {\n        display: none;\n      }\n    </style>\n\n    <div class=\"header\"><a class=\"header-title\" href=\"/\">Blag</a></div>\n    <div id=\"pages\">\n      <blag-page-main route=\"/\"></blag-page-main>\n      <blag-page-article id=\"articlePage\" route=\"/article\"></blag-page-article>\n    </div>\n    `;\n  }\n\n  constructor() {\n    super();\n    this._routes = {};\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    onRouteChange((path, query, hash) => {\n      // Some browsers call `onRouteChange` before `ready`.\n      // If this happens, `this._routes` is still empty.\n      // In that case, simply defer the call to `_routeChanged`.\n      if (Object.keys(this._routes).length === 0) {\n        setTimeout(() => {\n          this._routeChanged(newRoute, oldRoute);\n        }, 0);\n        return;\n      }\n\n      const oldPath = this._oldPath;\n      let newPath = path;\n\n      let article;\n      if ((article = newPath.match(/^\\/article\\/([^\\/]*)/))) {\n        newPath = '/article';\n        this.$.articlePage.article = article[1];\n      }\n\n      this._oldPath = newPath;\n\n      // Hide the old page\n      if (this._routes[oldPath]) {\n        this._routes[oldPath].classList.remove('visible');\n      }\n\n      // Show the new page\n      if (this._routes[newPath]) {\n        this._routes[newPath].classList.add('visible');\n      } else {\n        // Go back if the new page does not exist (and the old page does)\n        if (this._routes[oldPath]) {\n          console.warn('Requested page does not exist');\n          window.history.back();\n        }\n      }\n    });\n\n    // Make a map of all pages\n    Array.prototype.map.call(this.$.pages.children, page => {\n      this._routes[page.getAttribute('route')] = page;\n    });\n\n    // Redirect to main page if the initial path does not exist\n    this._oldPath = '/';\n\n    // Trigger initial load\n    window.dispatchEvent(new Event('location-changed'));\n  }\n}\n\ncustomElements.define(BlagApp.is, BlagApp);\n"]}